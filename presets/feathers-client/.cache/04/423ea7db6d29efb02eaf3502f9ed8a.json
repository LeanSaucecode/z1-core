{"id":"Di21","dependencies":[{"name":"/Users/barry/Documents/code/z1-core/presets/feathers-client/package.json","includedInParent":true,"mtime":1578318143340},{"name":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/package.json","includedInParent":true,"mtime":1576530433140},{"name":"engine.io-client","loc":{"line":6,"column":18},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/engine.io-client/lib/index.js"},{"name":"./socket","loc":{"line":7,"column":21},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/socket.js"},{"name":"component-emitter","loc":{"line":8,"column":22},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/component-emitter/index.js"},{"name":"socket.io-parser","loc":{"line":9,"column":21},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-parser/index.js"},{"name":"./on","loc":{"line":10,"column":17},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/on.js"},{"name":"component-bind","loc":{"line":11,"column":19},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/component-bind/index.js"},{"name":"debug","loc":{"line":12,"column":20},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/debug/src/browser.js"},{"name":"indexof","loc":{"line":13,"column":22},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/indexof/index.js"},{"name":"backo2","loc":{"line":14,"column":22},"parent":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/socket.io-client/lib/manager.js","resolved":"/Users/barry/Documents/code/z1-core/presets/feathers-client/node_modules/backo2/index.js"}],"generated":{"js":"var $Di21$exports={},$Di21$var$eio=$parcel$require(\"Di21\",\"engine.io-client\"),$Di21$var$Socket=$parcel$require(\"Di21\",\"./socket\"),$Di21$var$Emitter=$parcel$require(\"Di21\",\"component-emitter\"),$Di21$var$parser=$parcel$require(\"Di21\",\"socket.io-parser\"),$Di21$var$on=$parcel$require(\"Di21\",\"./on\"),$Di21$var$bind=$parcel$require(\"Di21\",\"component-bind\"),$Di21$var$debug=$parcel$require(\"Di21\",\"debug\")(\"socket.io-client:manager\"),$Di21$var$indexOf=$parcel$require(\"Di21\",\"indexof\"),$Di21$var$Backoff=$parcel$require(\"Di21\",\"backo2\"),$Di21$var$has=Object.prototype.hasOwnProperty;function $Di21$var$Manager(t,e){if(!(this instanceof $Di21$var$Manager))return new $Di21$var$Manager(t,e);t&&\"object\"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||\"/socket.io\",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new $Di21$var$Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState=\"closed\",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||$Di21$var$parser;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}$Di21$exports=$Di21$var$Manager,$Di21$var$Manager.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)$Di21$var$has.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},$Di21$var$Manager.prototype.updateSocketIds=function(){for(var t in this.nsps)$Di21$var$has.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},$Di21$var$Manager.prototype.generateId=function(t){return(\"/\"===t?\"\":t+\"#\")+this.engine.id},$Di21$var$Emitter($Di21$var$Manager.prototype),$Di21$var$Manager.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},$Di21$var$Manager.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},$Di21$var$Manager.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},$Di21$var$Manager.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},$Di21$var$Manager.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},$Di21$var$Manager.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},$Di21$var$Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},$Di21$var$Manager.prototype.open=$Di21$var$Manager.prototype.connect=function(t,e){if($Di21$var$debug(\"readyState %s\",this.readyState),~this.readyState.indexOf(\"open\"))return this;$Di21$var$debug(\"opening %s\",this.uri),this.engine=$Di21$var$eio(this.uri,this.opts);var n=this.engine,i=this;this.readyState=\"opening\",this.skipReconnect=!1;var o=$Di21$var$on(n,\"open\",function(){i.onopen(),t&&t()}),r=$Di21$var$on(n,\"error\",function(e){if($Di21$var$debug(\"connect_error\"),i.cleanup(),i.readyState=\"closed\",i.emitAll(\"connect_error\",e),t){var n=new Error(\"Connection error\");n.data=e,t(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;$Di21$var$debug(\"connect attempt will timeout after %d\",a);var s=setTimeout(function(){$Di21$var$debug(\"connect attempt timed out after %d\",a),o.destroy(),n.close(),n.emit(\"error\",\"timeout\"),i.emitAll(\"connect_timeout\",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(o),this.subs.push(r),this},$Di21$var$Manager.prototype.onopen=function(){$Di21$var$debug(\"open\"),this.cleanup(),this.readyState=\"open\",this.emit(\"open\");var t=this.engine;this.subs.push($Di21$var$on(t,\"data\",$Di21$var$bind(this,\"ondata\"))),this.subs.push($Di21$var$on(t,\"ping\",$Di21$var$bind(this,\"onping\"))),this.subs.push($Di21$var$on(t,\"pong\",$Di21$var$bind(this,\"onpong\"))),this.subs.push($Di21$var$on(t,\"error\",$Di21$var$bind(this,\"onerror\"))),this.subs.push($Di21$var$on(t,\"close\",$Di21$var$bind(this,\"onclose\"))),this.subs.push($Di21$var$on(this.decoder,\"decoded\",$Di21$var$bind(this,\"ondecoded\")))},$Di21$var$Manager.prototype.onping=function(){this.lastPing=new Date,this.emitAll(\"ping\")},$Di21$var$Manager.prototype.onpong=function(){this.emitAll(\"pong\",new Date-this.lastPing)},$Di21$var$Manager.prototype.ondata=function(t){this.decoder.add(t)},$Di21$var$Manager.prototype.ondecoded=function(t){this.emit(\"packet\",t)},$Di21$var$Manager.prototype.onerror=function(t){$Di21$var$debug(\"error\",t),this.emitAll(\"error\",t)},$Di21$var$Manager.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new $Di21$var$Socket(this,t,e),this.nsps[t]=n;var i=this;n.on(\"connecting\",o),n.on(\"connect\",function(){n.id=i.generateId(t)}),this.autoConnect&&o()}function o(){~$Di21$var$indexOf(i.connecting,n)||i.connecting.push(n)}return n},$Di21$var$Manager.prototype.destroy=function(t){var e=$Di21$var$indexOf(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},$Di21$var$Manager.prototype.packet=function(t){$Di21$var$debug(\"writing packet %j\",t);var e=this;t.query&&0===t.type&&(t.nsp+=\"?\"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var i=0;i<n.length;i++)e.engine.write(n[i],t.options);e.encoding=!1,e.processPacketQueue()}))},$Di21$var$Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},$Di21$var$Manager.prototype.cleanup=function(){$Di21$var$debug(\"cleanup\");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},$Di21$var$Manager.prototype.close=$Di21$var$Manager.prototype.disconnect=function(){$Di21$var$debug(\"disconnect\"),this.skipReconnect=!0,this.reconnecting=!1,\"opening\"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState=\"closed\",this.engine&&this.engine.close()},$Di21$var$Manager.prototype.onclose=function(t){$Di21$var$debug(\"onclose\"),this.cleanup(),this.backoff.reset(),this.readyState=\"closed\",this.emit(\"close\",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},$Di21$var$Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)$Di21$var$debug(\"reconnect failed\"),this.backoff.reset(),this.emitAll(\"reconnect_failed\"),this.reconnecting=!1;else{var e=this.backoff.duration();$Di21$var$debug(\"will wait %dms before reconnect attempt\",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||($Di21$var$debug(\"attempting reconnect\"),t.emitAll(\"reconnect_attempt\",t.backoff.attempts),t.emitAll(\"reconnecting\",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?($Di21$var$debug(\"reconnect attempt error\"),t.reconnecting=!1,t.reconnect(),t.emitAll(\"reconnect_error\",e.data)):($Di21$var$debug(\"reconnect success\"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},$Di21$var$Manager.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll(\"reconnect\",t)};"},"sourceMaps":null,"error":null,"hash":"8dfab16cb2b15e4612a765b0440913fe","cacheData":{"env":{},"imports":{"$require$engine.io-client":["engine.io-client","*"],"$require$./socket":["./socket","*"],"$require$component-emitter":["component-emitter","*"],"$require$socket.io-parser":["socket.io-parser","*"],"$require$./on":["./on","*"],"$require$component-bind":["component-bind","*"],"$require$debug":["debug","*"],"$require$indexof":["indexof","*"],"$require$backo2":["backo2","*"]},"exports":{},"wildcards":[],"sideEffects":true,"isCommonJS":true}}